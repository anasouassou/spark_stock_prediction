from pyspark.sql import SparkSession

# Create Spark session
spark = SparkSession.builder.appName("Stock Price Analysis").getOrCreate()

# Load the JSON data
data = spark.read.json("apple_stock_data.json")

# Show schema and a few rows
data.printSchema()

# Select relevant columns (adjust based on the dataset structure)
data = data.select("Date", "Open", "High", "Low", "Close", "Volume")

# Show the cleaned dataset
data.show(5)
